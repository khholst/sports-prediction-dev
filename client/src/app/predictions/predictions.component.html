
<div class="container">
    <div *ngIf="isLoading" class="row loading">
        <div class="col text-center">
                <img src="assets/blocks.svg" alt="Loading icon" width="100">
        </div>
    </div>
</div>


<div class="container">
    <main *ngIf="!isLoading">
        <div class="container">
            <div class="row text-center justify-content-center">
                <div class="col-lg-8">
                    <ng-container *ngFor="let index of numTournaments"></ng-container>
                    <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs">
                        <ng-container *ngFor="let index of numTournaments">
                                <li [ngbNavItem]="index">
                                  <a ngbNavLink (click)="tournamentChange(index)">{{filteredPredictions[index].tournament_id.name}}</a>
                                  
                                  <ng-template ngbNavContent>
                                    <div class="container">
                                        <div class="row justify-content-center">
                                            <div class="col-sm-7 col-lg-5">
                                                <div class="btn-group flex-wrap" role="group" aria-label="Basic radio toggle button group">
                                                    <input type="radio" class="btn-check" name="btnradio" (click)="onFilter('UPCOMING', index)" id="btnradio1" autocomplete="off" checked>
                                                    <label class="btn btn-outline-primary" for="btnradio1">UPCOMING</label>
                                                  
                                                    <input type="radio" class="btn-check" name="btnradio" (click)="onFilter('FINISHED', index)" id="btnradio2" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="btnradio2">FINISHED</label>
                                                  
                                                    <input type="radio" class="btn-check" name="btnradio" (click)="onFilter('ALL', index)" id="btnradio3" autocomplete="off">
                                                    <label class="btn btn-outline-primary" for="btnradio3">ALL</label>
                                                </div>
                                            </div>
                                            <div class="col-sm-5 col-lg-3">
                                                <fa-icon *ngIf="sortAscending" class="sortIcon" [icon]="sortAscIcon" style="font-size: 23px; vertical-align: middle; float:right; margin-left: 10px; margin-top: 3px;" (click)="changeSortOrder(index)"></fa-icon> 
                                                <fa-icon *ngIf="!sortAscending" class="sortIcon" [icon]="sortDescIcon" style="font-size: 23px; vertical-align: middle; float:right; margin-left: 10px; margin-top: 3px;" (click)="changeSortOrder(index)"></fa-icon> 
                                                <select style="max-width: 100px; float: right;" class="form-select form-select-md mb-3" (change)="changeSortField(index)">
                                                    <option selected>Date</option>
                                                    <option>Points</option>
                                                </select>
                                                <span style="float: right; margin-top: 7px; margin-right: 5px;">Sort:</span>
                                            </div>
                                        </div>
                                        
                                        <div class="row justify-content-center">
                                            <div class="col-lg-8">
                                                <div *ngFor="let game of filteredPredictions[index].predictions" class="card">
                                                    <div [ngClass]="game.score1 != -1 || game.game_id.hasStarted  ? 'predicted-card' : ''" 
                                                    
                                                    id="{{game.game_id._id + ':card'}}" class="card-body">
    
                                                        <div class="container">
                                                            <div class="row">
                                                                <div class="col-sm-4 text-sm-end text-center order-sm-1">
                                                                    <p><span class="badge bg-dark">{{ getStageName(game.game_id.stage)}}</span></p>
                                                                </div>
                                                                <div class="col-sm-4 text-sm-start text-center">
                                                                    <p class="game-date">{{game.game_id.printTime.split(" ")[0]}}</p>
                                                                </div>
                                                                <div class="col-sm-4 text-center">
                                                                    <p class="game-time"><b>{{game.game_id.printTime.split(" ")[1]}}</b></p>
                                                                </div>
                                                            </div>
                                                            <form>
                                                                <div class="row">
                                                                        <div class="col-sm-5 text-sm-end text-center team1-div">
                                                                            <img [src]="'https://countryflagsapi.com/png/' + game.game_id.team1" class="flag">
                                                                            {{game.game_id.team1.toUpperCase()}}
                                                                            <input *ngIf="game.score1 != -1 && game.score1 != -999" value="{{ game.score1 }}" disabled>
                                                                            <input *ngIf="game.score1 == -1 && !game.game_id.hasStarted" id="{{game.game_id._id + ':team1'}}" type="number" min="0" value="0">
                                                                            <input *ngIf="game.score1 == -999 || (game.game_id.hasStarted && game.score1 == -1)" value="" disabled>
                                                                        </div>
                                                                    
                                                                        <div class="col-sm-2 text-center d-none d-sm-block">
                                                                            <span>VS</span>
                                                                        </div>
                                                                        <div class="col-sm-5 team2-div text-sm-start text-center align-items-center">                                                                        
                                                                                <input class="score2" *ngIf="game.score2 != -1 && game.score2 != -999" value="{{ game.score2 }}" disabled>
                                                                                <input class="score2" *ngIf="game.score2 == -1 && !game.game_id.hasStarted" id="{{game.game_id._id + ':team2'}}" type="number" min="0" value="0">
                                                                                <input class="score2" *ngIf="game.score2 == -999 || (game.game_id.hasStarted && game.score2 == -1)" value="" disabled>
                                                                                <p class="team2" style="margin: 0px 9px 0px 9px;">{{game.game_id.team2.toUpperCase()}}</p>
                                                                                <img class="flag2" [src]="'https://countryflagsapi.com/png/' + game.game_id.team2" class="flag">                                                                        
                                                                        </div>
                                                                </div>
    
                                                                    <div class="row text-center">
                                                                        <div class="col">
                                                                            <button [ngClass]="game.score1 != -1 || game.game_id.hasStarted ? 'predicted-button' : ''"  type="submit" id="{{game.game_id._id + ':submit'}}" class="btn btn-primary" (click)="onPrediction(game.game_id._id)">Save</button>
                                                                        </div>
                                                                    </div>
    
                                                                
                                                            </form>
                                                            <div *ngIf="game.points != -1 && game.points != -999">
                                                                <hr>
                                                                    <div class="row text-center">
                                                                        <p class="result">Result:
                                                                        <b>{{ game.game_id.score1 }} : {{ game.game_id.score2 }}</b>
                                                                        <br>
                                                                        <span *ngIf="game.points == 1; else notOne" class="badge rounded-pill bg-warning">{{ game.points }} POINT</span>
                                                                        <ng-template #notOne><span [ngClass]="badgeClasses[game.points]" class="badge rounded-pill">{{ game.points }} POINTS</span> </ng-template>
                                                                    </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                  </ng-template>
                                </li>
                        </ng-container>
                    </ul>
                </div>
            </div>
        </div>
        <div [ngbNavOutlet]="nav" class="mt-2"></div>
    </main>
</div>
  
